{% extends "base.html" %}

{% block title %}Instrukcja Obsługi{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">Instrukcja Obsługi Aplikacji</h1>
    <p class="lead">Niniejsza instrukcja opisuje szczegółowo wszystkie funkcje i sposób korzystania z aplikacji do zarządzania bazą firm, ofertami i analizami cenowymi.</p>

    <h2>Spis Treści</h2>
    <ol>
        <li><a href="#logowanie">Logowanie i Zmiana Motywu</a></li>
        <li><a href="#nawigacja">Nawigacja i Pulpit (Strona Główna)</a></li>
        <li><a href="#modul-firm">Moduł Firm</a>
            <ul>
                <li><a href="#lista-firm">Lista Firm i Filtrowanie</a></li>
                <li><a href="#szczegoly-firmy">Szczegóły Firmy</a></li>
                <li><a href="#dodawanie-edycja-firmy">Dodawanie i Edycja Firmy</a></li>
                <li><a href="#eksport-firm">Eksport Listy Firm</a></li>
            </ul>
        </li>
        <li><a href="#modul-ofert">Moduł Ofert</a>
            <ul>
                <li><a href="#lista-ofert">Lista Ofert</a></li>
                <li><a href="#dodawanie-edycja-oferty">Dodawanie i Edycja Oferty</a></li>
                <li><a href="#szczegoly-oferty">Szczegóły Oferty i Pozycje Cenowe</a></li>
            </ul>
        </li>
        <li><a href="#modul-analiz">Moduł Analiz</a>
            <ul>
                <li><a href="#analiza-cen">Porównanie Cen Jednostkowych</a></li>
                <li><a href="#pulpit-analityczny">Pulpit Analityczny</a></li>
                <li><a href="#wszystkie-ceny">Wszystkie Ceny Jednostkowe</a></li>
            </ul>
        </li>
        <li><a href="#slowniki">Zarządzanie Słownikami (Ustawienia)</a></li>
    </ol>

    <hr class="my-4">

    <section id="logowanie" class="mb-5">
        <h2>1. Logowanie i Zmiana Motywu</h2>
        <p><strong>Logowanie:</strong> Aby uzyskać dostęp do funkcji aplikacji, użytkownik musi się zalogować. Formularz logowania dostępny jest pod przyciskiem <strong>"Zaloguj"</strong> w prawym górnym rogu ekranu. Należy podać nazwę użytkownika i hasło.</p>
        <p><strong>Wylogowywanie:</strong> Aby się wylogować, należy kliknąć przycisk <strong>"Wyloguj (nazwa użytkownika)"</strong> znajdujący się w tym samym miejscu.</p>
        <p><strong>Zmiana Motywu:</strong> Obok przycisku logowania znajduje się przełącznik (ikona słońca/księżyca), który pozwala na zmianę motywu graficznego interfejsu (jasny/ciemny). Wybór jest zapamiętywany w przeglądarce i zostanie automatycznie zastosowany przy kolejnych wizytach.</p>
    </section>

    <hr class="my-4">

    <section id="nawigacja" class="mb-5">
        <h2>2. Nawigacja i Pulpit (Strona Główna)</h2>
        <p>Po zalogowaniu użytkownik trafia na <strong>Pulpit</strong>, który zawiera karty z szybkimi linkami do głównych modułów aplikacji:</p>
        <ul>
            <li><strong>Zarządzanie Firmami:</strong> Przenosi do interfejsu zarządzania firmami, gdzie można przeglądać, filtrować i dodawać nowe firmy.</li>
            <li><strong>Zarządzanie Ofertami:</strong> Przenosi do modułu ofertowego, służącego do archiwizacji i analizy ofert.</li>
            <li><strong>Analizy i Raporty:</strong> Przenosi bezpośrednio do pulpitu analitycznego, gdzie można wizualizować trendy cenowe.</li>
        </ul>
        <p>Główna nawigacja aplikacji znajduje się na górnym pasku i jest podzielona na rozwijane menu, zapewniając łatwy dostęp do wszystkich funkcji:</p>
        <ul>
            <li><strong>Strona główna (ikona domu):</strong> Zawsze przenosi z powrotem do Pulpitu.</li>
            <li><strong>Firmy:</strong>
                <ul>
                    <li><strong>Lista Firm:</strong> Główny widok modułu firm.</li>
                    <li><strong>Dodaj nową firmę:</strong> Otwiera formularz dodawania nowej firmy.</li>
                    <li><strong>Osoby:</strong> Dostęp do globalnej listy wszystkich osób kontaktowych.</li>
                    <li><strong>Oceny:</strong> Dostęp do globalnej listy wszystkich ocen współpracy.</li>
                </ul>
            </li>
            <li><strong>Oferty:</strong>
                 <ul>
                    <li><strong>Lista Ofert:</strong> Główny widok modułu ofert.</li>
                    <li><strong>Dodaj nową ofertę:</strong> Otwiera formularz dodawania nowej oferty.</li>
                </ul>
            </li>
            <li><strong>Analizy:</strong>
                <ul>
                    <li><strong>Porównanie cen jednostkowych:</strong> Narzędzie do dynamicznego porównywania cen tych samych robót w różnych ofertach.</li>
                    <li><strong>Wszystkie ceny jednostkowe:</strong> Globalna, przeszukiwalna lista wszystkich pozycji cenowych z wszystkich ofert.</li>
                    <li><strong>Pulpit Analityczny:</strong> Wizualizacja danych cenowych w formie wykresów.</li>
                </ul>
            </li>
            <li><strong>Ustawienia (ikona koła zębatego):</strong> Centralne miejsce do zarządzania słownikami aplikacji (patrz rozdział 6).</li>
        </ul>
    </section>

    <hr class="my-4">

    <section id="modul-firm" class="mb-5">
        <h2>3. Moduł Firm</h2>
        <h3 id="lista-firm">3.1. Lista Firm i Filtrowanie</h3>
        <p>Interfejs listy firm (dostępny z menu <strong>"Firmy" -> "Lista Firm"</strong>) jest podzielony na dwie kolumny, co zapewnia wygodę pracy:</p>
        <div class="row">
            <div class="col-md-6">
                <strong>Lewa kolumna (Filtrowanie):</strong>
                <p>Zawiera panel z filtrami, który jest zawsze widoczny na większych ekranach. Można tu precyzyjnie zawęzić listę firm, korzystając z:</p>
                <ul>
                    <li><strong>Wyszukiwania tekstowego:</strong> Bardzo potężne narzędzie, które przeszukuje niemal wszystkie informacje powiązane z firmą: nazwę, stronę WWW, uwagi, dane adresowe, e-maile, telefony, imiona i nazwiska osób kontaktowych, a nawet treść komentarzy w ocenach.</li>
                    <li><strong>Specjalności:</strong> Lista wielokrotnego wyboru.</li>
                    <li><strong>Województwo i Powiat:</strong> Filtry zależne - po wybraniu województwa, lista powiatów jest automatycznie aktualizowana. System inteligentnie pokazuje firmy działające w danym powiecie, całym województwie oraz te o zasięgu ogólnokrajowym.</li>
                    <li><strong>Typ firmy:</strong> Lista jednokrotnego wyboru.</li>
                </ul>
                <p>Po ustawieniu kryteriów należy użyć przycisku <strong>"Filtruj"</strong>. Przycisk <strong>"Resetuj"</strong> czyści wszystkie filtry. Na urządzeniach mobilnych panel filtrów jest domyślnie ukryty i można go otworzyć przyciskiem "Filtry".</p>
            </div>
            <div class="col-md-6">
                <strong>Prawa kolumna (Lista firm):</strong>
                <p>Wyświetla tabelę z przefiltrowaną listą firm. Tabela pokazuje ID i nazwę firmy.</p>
            </div>
        </div>

        <h3 id="szczegoly-firmy" class="mt-4">3.2. Szczegóły Firmy</h3>
        <p>Kliknięcie na dowolny wiersz z firmą na liście powoduje płynne rozwinięcie panelu ze szczegółowymi informacjami o tej firmie, bez przeładowywania strony. Panel ten zawiera wszystkie kluczowe dane w przejrzystych sekcjach:</p>
        <ul>
            <li>Dane ogólne (nazwa, typ, strona, uwagi).</li>
            <li>Średnia ocen.</li>
            <li>Obszar działania i specjalności.</li>
            <li>Dane kontaktowe (adresy, e-maile, telefony).</li>
            <li>Osoby kontaktowe.</li>
            <li>Historia ocen współpracy.</li>
        </ul>
        <p>W panelu szczegółów znajduje się również przycisk <strong>"Edytuj"</strong>, który przenosi do pełnego formularza edycji danej firmy.</p>

        <h3 id="dodawanie-edycja-firmy" class="mt-4">3.3. Dodawanie i Edycja Firmy</h3>
        <p>Formularz dodawania nowej firmy (dostępny z menu "Firmy" -> "Dodaj nową firmę") oraz formularz edycji to jeden, długi widok, podzielony na logiczne sekcje w formie kart. Taka budowa ułatwia wprowadzanie dużej ilości danych.</p>
        <ul>
            <li><strong>Dane podstawowe:</strong> Nazwa firmy (wymagane), typ, strona WWW, uwagi.</li>
            <li><strong>Adresy, E-maile, Telefony:</strong> W każdej z tych sekcji można dodać wiele pozycji za pomocą przycisku <strong>"Dodaj kolejny..."</strong>. Dla każdej pozycji można wybrać typ z listy (np. adres główny, telefon służbowy). Obok listy wyboru typu znajduje się przycisk <strong>"+"</strong>, który otwiera okno modalne pozwalające na szybkie dodanie nowej wartości do słownika (np. nowego typu adresu) bez opuszczania formularza firmy.</li>
            <li><strong>Specjalizacje i Rynek:</strong>
                <ul>
                    <li><strong>Specjalności:</strong> Pole wielokrotnego wyboru z wyszukiwarką.</li>
                    <li><strong>Obszar działania:</strong> Logika trzystopniowa: można wybrać "Cały kraj", "Wybrane województwa" (pojawia się pole wielokrotnego wyboru województw) lub "Wybrane powiaty" (pojawiają się pola wyboru województw i powiatów).</li>
                </ul>
            </li>
            <li><strong>Osoby kontaktowe i Oceny współpracy:</strong> Działają analogicznie do sekcji kontaktowych, pozwalając na dodawanie wielu osób i ocen za pomocą dedykowanych przycisków.</li>
        </ul>
        <p>Po wypełnieniu danych należy zapisać formularz przyciskiem <strong>"Zapisz firmę"</strong> na dole strony. Przycisk <strong>"Usuń firmę"</strong> (wymagający potwierdzenia) również znajduje się na samym dole formularza edycji.</p>

        <h3 id="eksport-firm" class="mt-4">3.4. Eksport Listy Firm</h3>
        <p>Na stronie z listą firm, w nagłówku prawej kolumny, znajduje się przycisk <strong>"Eksportuj widoczne"</strong>. Jego kliknięcie generuje nową stronę HTML z tabelą zawierającą szczegółowe dane wszystkich firm z aktualnie widocznej, przefiltrowanej listy. Stronę tę można łatwo wydrukować lub zapisać do pliku PDF z poziomu przeglądarki.</p>
    </section>

    <hr class="my-4">

    <section id="modul-ofert" class="mb-5">
        <h2>4. Moduł Ofert</h2>
        <p>Moduł ten służy do archiwizowania dokumentów ofertowych i zbierania danych o cenach jednostkowych na potrzeby przyszłych analiz.</p>
        
        <h3 id="lista-ofert">4.1. Lista Ofert</h3>
        <p>Dostępna z menu <strong>"Oferty" -> "Lista Ofert"</strong>. Prezentuje tabelę z zarejestrowanymi ofertami. Kluczowe kolumny to:</p>
        <ul>
            <li><strong>Nazwa, Projekt, Data Złożenia, Status:</strong> Podstawowe informacje identyfikujące ofertę.</li>
            <li><strong>Akcje:</strong> Zawiera przycisk <strong>Pobierz</strong> (ikona strzałki w dół), który pozwala na pobranie na dysk oryginalnego pliku załączonego do oferty.</li>
        </ul>

        <h3 id="dodawanie-edycja-oferty" class="mt-4">4.2. Dodawanie i Edycja Oferty</h3>
        <p>Formularz dodawania nowej oferty (lub edycji istniejącej) zawiera następujące pola:</p>
        <ul>
            <li><strong>Nazwa oferty:</strong> Własny identyfikator oferty.</li>
            <li><strong>Projekt:</strong> Możliwość przypisania oferty do projektu.</li>
            <li><strong>Data złożenia i Status.</strong></li>
            <li><strong>Plik oferty:</strong> Kluczowe pole umożliwiające załączenie oryginalnego dokumentu (np. w formacie PDF).</li>
        </ul>

        <h3 id="szczegoly-oferty" class="mt-4">4.3. Szczegóły Oferty i Wprowadzanie Cen Jednostkowych</h3>
        <p>Po przejściu do szczegółów konkretnej oferty, interfejs dzieli się na dwa panele, co stanowi o jego głównej funkcjonalności:</p>
        <div class="row">
            <div class="col-md-6">
                <strong>Panel Lewy (Podgląd Oferty):</strong>
                <p>W tym panelu wyświetlany jest podgląd załączonego pliku oferty. Umożliwia to wygodne przeglądanie oryginalnego dokumentu bez potrzeby otwierania go w osobnym programie.</p>
            </div>
            <div class="col-md-6">
                <strong>Panel Prawy (Pozycje Cenowe):</strong>
                <p>Ten panel służy do wprowadzania poszczególnych pozycji cenowych z dokumentu oglądanego po lewej stronie. Dla każdej pozycji należy podać:</p>
                <ul>
                    <li>Rodzaj roboty (ze słownika)</li>
                    <li>Kategorię (ze słownika)</li>
                    <li>Cenę jednostkową</li>
                    <li>Jednostkę miary</li>
                    <li>Uwagi (opcjonalnie)</li>
                </ul>
            </div>
        </div>
        <div class="alert alert-info mt-4" role="alert">
            <h4 class="alert-heading">Kluczowa funkcjonalność</h4>
            <p>Głównym celem tego widoku jest umożliwienie użytkownikowi jednoczesnego podglądu oryginalnej oferty (po lewej) i wprowadzania na tej podstawie cen jednostkowych (po prawej). Aplikacja nie obsługuje 'ilości' ani nie oblicza automatycznie wartości oferty. Służy do precyzyjnego zbierania danych o cenach jednostkowych w celu ich późniejszej analizy.</p>
        </div>
    </section>

    <hr class="my-4">

    <section id="modul-analiz" class="mb-5">
        <h2>5. Moduł Analiz</h2>
        <p>Narzędzia analityczne pozwalają na głębsze zrozumienie danych cenowych zgromadzonych w module ofert.</p>
        <h3 id="analiza-cen">5.1. Porównanie Cen Jednostkowych</h3>
        <p>To narzędzie (<strong>"Analizy" -> "Porównanie cen jednostkowych"</strong>) pozwala na dynamiczne porównywanie cen jednostkowych dla tych samych rodzajów robót pomiędzy różnymi ofertami. Użytkownik może wybrać z listy jeden lub więcej interesujących go rodzajów robót, a system wyświetli tabelę porównawczą, pokazując ceny z różnych ofert. Ułatwia to identyfikację najkorzystniejszych propozycji i analizę rozbieżności cenowych.</p>

        <h3 id="pulpit-analityczny" class="mt-4">5.2. Pulpit Analityczny</h3>
        <p>Dostępny z Pulpitu lub menu <strong>"Analizy" -> "Pulpit Analityczny"</strong>, ten widok prezentuje zagregowane dane w formie interaktywnych wykresów. Umożliwia analizę trendów cenowych dla wybranych rodzajów robót w czasie. Po wybraniu rodzaju roboty, wykresy pokazują, jak zmieniały się ceny minimalne, maksymalne i średnie w poszczególnych okresach (np. kwartałach), co pozwala na ocenę dynamiki rynku i prognozowanie kosztów.</p>
        
        <h3 id="wszystkie-ceny" class="mt-4">5.3. Wszystkie Ceny Jednostkowe</h3>
        <p>Jest to globalna, przeszukiwalna i filtrowalna lista wszystkich pozycji cenowych wprowadzonych do systemu (<strong>"Analizy" -> "Wszystkie ceny jednostkowe"</strong>). Pozwala na szybkie znalezienie konkretnej ceny lub przejrzenie wszystkich wpisów dla danego rodzaju roboty lub projektu.</p>
    </section>

    <hr class="my-4">

    <section id="slowniki" class="mb-5">
        <h2>6. Zarządzanie Słownikami (Ustawienia)</h2>
        <p>W menu <strong>"Ustawienia"</strong> (ikona koła zębatego) znajduje się dostęp do zarządzania wszystkimi słownikami w aplikacji. Utrzymanie porządku w słownikach jest kluczowe dla spójności danych. Są one podzielone na dwie grupy:</p>
        <ul>
            <li><strong>Słowniki Firm:</strong>
                <ul>
                    <li>Specjalności</li>
                    <li>Typy firm</li>
                    <li>Typy adresów</li>
                    <li>Typy telefonów</li>
                    <li>Typy e-maili</li>
                </ul>
            </li>
            <li><strong>Słowniki Ofert:</strong>
                <ul>
                    <li>Projekty</li>
                    <li>Kategorie cen</li>
                    <li>Rodzaje robót</li>
                </ul>
            </li>
        </ul>
        <p>Każda strona zarządzania słownikiem pozwala na dodawanie, edycję i usuwanie pozycji. Usunięcie pozycji jest możliwe tylko wtedy, gdy nie jest ona używana w żadnym miejscu w aplikacji, co chroni integralność danych.</p>
    </section>

</div>
{% endblock %}
